<%@page import="java.net.URLEncoder"%><%@ page contentType="text/html; charset=EUC-KR" %><%@ page import="java.util.List" %><%@ page import="java.util.Locale" %><%@ page import="com.sds.acube.app.common.util.CommonUtil" %><%@ taglib uri="http://www.springframework.org/tags" prefix="spring" %><%@ page import="org.jconfig.Configuration" %><%@ page import="com.sds.acube.app.common.util.AppConfig" %><%@ page import="org.springframework.web.context.WebApplicationContext" %> <%@ page import="org.springframework.web.context.support.WebApplicationContextUtils" %><%@ page import="org.springframework.context.MessageSource" %> <%    String docId = request.getParameter("docId");    String lobCode   = request.getParameter("lobCode");// 연동 또는 결재문서를 구분        //첨부문서 관련 처리를 위한 파라미터 수신 by jkkim 2015.08.06	String fileId = request.getParameter("fileId");if(fileId == null){ fileId = ""; }	String fileName   = request.getParameter("fileName");if(fileName == null){ fileName = ""; }	String displayFileName   = request.getParameter("displayName");if(displayFileName == null){ displayFileName = ""; }	String encDiplayName = "";	if(!displayFileName.equals("")){		encDiplayName = java.net.URLEncoder.encode(displayFileName,"UTF-8");	}	String fileKind = request.getParameter("fileKind");if(fileKind == null){ fileKind = ""; }		String webUri = AppConfig.getProperty("web_uri", "/ep", "path");	String userId = request.getParameter("userId");	String clientTime = request.getParameter("clientTime");// added by jkkim 업무쪽에서 xplatform과 상태값을 주고받기 위해 처리	WebApplicationContext ctx = WebApplicationContextUtils.getWebApplicationContext(pageContext.getServletContext());	MessageSource messageSource = (MessageSource)ctx.getBean("messageSource");	Locale langType = (Locale)session.getAttribute("LANG_TYPE");	CommonUtil.sessionInit(session); // 세션 초기화	session.setAttribute("LANG_TYPE", new Locale("ko", "KR"));	session.setAttribute("org.springframework.web.servlet.i18n.SessionLocaleResolver.LOCALE", new Locale("ko","KR"));	session.setAttribute("clientTime",clientTime);// added by jkkim 업무쪽에서 xplatform과 상태값을 주고받기 위해 처리	int adminCount = 1;	    String[] localeLanguage = AppConfig.getArray("lang", new String[]{"ko"}, "locale");    String[] displayName = AppConfig.getArray("display_name", new String[]{"Korean"}, "locale");    boolean useHttps = AppConfig.getBooleanProperty("use_https", true);    String password = AppConfig.getProperty("systemUser", "", "systemOperation");%><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><title>Approval System Login [Developer mode]</title><script type="text/javascript" src="<%=webUri%>/app/ref/js/jquery.js" charset="EUC-KR"></script><script type="text/javascript" src="<%=webUri%>/app/ref/js/app.js" charset="EUC-KR"></script><%	if(useHttps==false) { %><script type="text/javascript" src="<%=webUri%>/app/ref/js/seed.js"></script><%	} %><script type="text/javascript">var isover = "N";var myint;var LoginPortlet = {	validateLogin : function () {		//validation		if(app.isNullOrEmpty($('#id').val())) {			alert("<spring:message code="app.alert.msg.171" text="연계로그인 시에는 아이디가 반드시 필요합니다."/>");			// alert("<spring:message code='app.alert.msg.171' />");		} else if(app.isNullOrEmpty($('#pw').val())) {			alert("<spring:message code="app.alert.msg.172" text="연계로그인 시에는 패스워드가 반드시 필요합니다."/>");			// alert("<spring:message code='app.alert.msg.172' />");		} else {			LoginPortlet.loginProcess();		}	},			loginProcess : function() {<%	if(useHttps==false) { %>		// Seed Encrypt		$('#loginId').val(document.getElementById("seedOCX").SeedEncryptData($('#id').val()));		$('#password').val(document.getElementById("seedOCX").SeedEncryptData($('#pw').val()));<%	} else { %>		$('#loginId').val($('#id').val());		$('#password').val($('#pw').val());<%	} %>    $("#displayName").val("<%=encDiplayName%>");	$('#adminLoginform').attr("action", "<%=webUri%>/app/login/loginProcessByLegacy.do");	$('#adminLoginform').submit();	},	logoutProcess : function() {		callJson("logoutSysController", "getList", "", function(data) {			for(var i=0; i < data.length; i++) {				$('body').append("<iframe id='logoutHelpIframe"+i+"' class='dialog'></iframe>");				$('#logoutHelpIframe'+i).attr('src',data[i].logoutUrl);			}						callJson("loginController", "logoutProcessByPortlet", "", function(data) {				setTimeout(function() {					top.location.reload();				}, 300);			});		});	},	prepareSeed: function() {	    var currRoundKey = document.getElementById("seedOCX").GetCurrentRoundKey();	    if (currRoundKey == "0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0") {	        var userkey = document.getElementById("seedOCX").GetUserKey();	        currRoundKey = document.getElementById("seedOCX").GetRoundKey(userkey);	    }	    var roundkey_c = document.getElementById("seedOCX").SeedEncryptRoundKey(currRoundKey);	    $('#roundkey').val(roundkey_c);	}};$(document).ready(function() {<%	if(useHttps==false) { %>		LoginPortlet.prepareSeed();<%	} %>	// 일반 포틀릿 인 경우	LoginPortlet.validateLogin();});</script></head><body>	<input type="hidden" id="id" name="id" value="<%=userId%>"/>	<input type="hidden" id="pw" name="pw" value="<%=password%>"/>	<form name="adminLoginform" id="adminLoginform" method="post">	<input type="hidden" name="page" value="<%=webUri%>"/>	<input type="hidden" name="PARTNER" value=""/>	<input type="hidden" id="roundkey" name="roundkey" />	<input type="hidden" id="loginId" name="loginId" />	<input type="hidden" id="password" name="password" />	<input type="hidden" id="lobCode" name="lobCode" value="<%=lobCode%>"/>	<input type="hidden" id="docId" name="docId" value="<%=docId%>" />		<input type="hidden" id="fileId" name="fileId" value="<%=fileId%>"/>	<input type="hidden" id="fileName" name="fileName" value="<%=fileName%>" />	<input type="hidden" id="displayName" name="displayName" />	<input type="hidden" id="fileKind" name="fileKind" value="<%=fileKind%>"/>  	</form></body></html>